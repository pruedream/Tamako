(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{355:function(a,s,n){"use strict";n.r(s);var e=n(4),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"背景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[a._v("#")]),a._v(" 背景")]),a._v(" "),s("p",[a._v("最近在实习的时候使用PageHelper分页时，需要对数据进行二次处理，但是出现错误出现错误可以分页但是数据量错误 ，")]),a._v(" "),s("h2",{attrs:{id:"原因"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#原因"}},[a._v("#")]),a._v(" 原因")]),a._v(" "),s("p",[a._v("PageHelper中startPage开启分页方法只对后面的sql查询起作用，在开启分页后对list进行了操作 。其实这时候放入PageInfo的数据已经不是原始数据了，而是进过二次处理的数据，所有分页已经失效了")]),a._v(" "),s("h2",{attrs:{id:"解决方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决方法"}},[a._v("#")]),a._v(" 解决方法")]),a._v(" "),s("p",[a._v("直接对分页后的PageInfo对象中的数据进行操作 ，即对PageInfo里的list进行操作")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("@Override\n@Transactional(rollbackFor = Exception.class)\npublic PageInfo getThemManageList(SysTopicManagerDTO sysTopicManagerDTO) {\n    PageHelper.startPage(sysTopicManagerDTO.getPageNum(),sysTopicManagerDTO.getPageSize());\n    SysTopicManageVo sysTopicManageVo=new SysTopicManageVo();\n    BeanUtils.copyBeanProp(sysTopicManageVo,sysTopicManagerDTO);\n    List<SysTopicManageVo> list = sysTopicManageMapper.list(sysTopicManageVo);\n    PageInfo<SysTopicManageVo> page = new PageInfo(list);//不处理直接构建PageInfo\n   \n   //PageInfo里的list与下面的list引用的是同一个地址空间\n    //赋值文件和图\n   for(SysTopicManageVo s:list){\n       List<BackgroundFile> file = backgroundService.findFile(s.getId());\n       List<BackgroundFileHandle> files = new ArrayList<>();\n       List<BackgroundFileHandle> previews = new ArrayList<>();\n       for(BackgroundFile backgroundFile:file){\n              if(backgroundFile.getModelType().equals(SysCommonConstant.FILE_MODEL_FILE)){\n                  BackgroundFileHandle backgroundFileHandle = new BackgroundFileHandle();\n                  backgroundFileHandle.setId(backgroundFile.getId());\n                  backgroundFileHandle.setUrl(backgroundFile.getUrl());\n                  files.add(backgroundFileHandle);\n              }else {\n                  BackgroundFileHandle backgroundFileHandle = new BackgroundFileHandle();\n                  backgroundFileHandle.setId(backgroundFile.getId());\n                  backgroundFileHandle.setUrl(backgroundFile.getUrl());\n                  previews.add(backgroundFileHandle);\n              }\n          }\n\n       s.setBackgroundPreviewList(previews);\n       s.setFileList(files);\n   }\n    return page;\n}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br")])]),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[a._v("#")]),a._v(" 总结")]),a._v(" "),s("p",[a._v("以往是不会注意到会有这些问题的，还是那句话实践出真知。")])])}),[],!1,null,null,null);s.default=r.exports}}]);